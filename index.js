var WebSocketServer=require("ws").Server,http=require("http"),express=require("express"),url=require("url"),port=process.env.PORT||5e3,app=express();app.use(express["static"](__dirname+"/public")),app.listen(80),console.log("app listening on %d ",80);var server=http.createServer(app);server.on("request",app),server.listen(port),console.log("http server listening on %d",port);var wss=new WebSocketServer({server:server});wss.on("connection",function(e){console.info("websocket connection open");var r=(url.parse(e.upgradeReq.url,!0),0),n={a:[null,null,null],b:[null,null,null],c:[null,null,null]},o=function(e){s(e),l(e),t(e)},s=function(r){for(var o in n){var s=0;n[o].every(function(n,o){return n===r?(2===s?e.send(r):s++,!0):!1})}},l=function(r){for(var o=0;3>o;o++)null!==n.a[o]&&n.a[o]===n.b[o]&&n.b[o]===n.c[o]&&e.send(r)},t=function(r){n.a[0]&&n.a[0]===n.b[1]&&n.b[1]===n.c[2]&&e.send(r),n.a[2]&&n.a[2]===n.b[1]&&n.b[1]===n.c[0]&&e.send(r)};e.on("message",function(s){console.log(s),r++;var l=r%2===1?"X":"O";n[move.row][move.col]=l,r>=5&&o(l),e.send({token:l,row:move.row,col:move.col})})}),console.log("websocket server created");
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbIldlYlNvY2tldFNlcnZlciIsInJlcXVpcmUiLCJTZXJ2ZXIiLCJodHRwIiwiZXhwcmVzcyIsInVybCIsInBvcnQiLCJwcm9jZXNzIiwiZW52IiwiUE9SVCIsImFwcCIsInVzZSIsIl9fZGlybmFtZSIsImxpc3RlbiIsImNvbnNvbGUiLCJsb2ciLCJzZXJ2ZXIiLCJjcmVhdGVTZXJ2ZXIiLCJvbiIsIndzcyIsIndzIiwiaW5mbyIsInR1cm4iLCJwYXJzZSIsInVwZ3JhZGVSZXEiLCJib2FyZFN0YXRlIiwiYSIsImIiLCJjIiwiY2hlY2tGb3JXaW5uZXIiLCJ0b2tlbiIsImNoZWNrUm93cyIsImNoZWNrQ29scyIsImNoZWNrRGlhZyIsInJvdyIsImNvdW50IiwiZXZlcnkiLCJ2YWx1ZSIsImluZGV4Iiwic2VuZCIsImkiLCJtZXNzYWdlIiwibW92ZSIsImNvbCJdLCJtYXBwaW5ncyI6IkFBQUEsR0FBQUEsaUJBQUFDLFFBQUEsTUFBQUMsT0FDQUMsS0FBQUYsUUFBQSxRQUNBRyxRQUFBSCxRQUFBLFdBQ0FJLElBQUFKLFFBQUEsT0FDQUssS0FBQUMsUUFBQUMsSUFBQUMsTUFBQSxJQUVBQyxJQUFBTixTQUNBTSxLQUFBQyxJQUFBUCxRQUFBQSxVQUFBUSxVQUFBLFlBQ0FGLElBQUFHLE9BQUEsSUFDQUMsUUFBQUMsSUFBQSx1QkFBQSxHQUVBLElBQUFDLFFBQUFiLEtBQUFjLGFBQUFQLElBQ0FNLFFBQUFFLEdBQUEsVUFBQVIsS0FDQU0sT0FBQUgsT0FBQVAsTUFDQVEsUUFBQUMsSUFBQSw4QkFBQVQsS0FFQSxJQUFBYSxLQUFBLEdBQUFuQixrQkFBQWdCLE9BQUFBLFFBQ0FHLEtBQUFELEdBQUEsYUFBQSxTQUFBRSxHQUNBTixRQUFBTyxLQUFBLDRCQUVBLElBSUFDLElBSkFqQixJQUFBa0IsTUFBQUgsRUFBQUksV0FBQW5CLEtBQUEsR0FJQSxHQUNBb0IsR0FDQUMsR0FBQSxLQUFBLEtBQUEsTUFDQUMsR0FBQSxLQUFBLEtBQUEsTUFDQUMsR0FBQSxLQUFBLEtBQUEsT0FFQUMsRUFBQSxTQUFBQyxHQUNBQyxFQUFBRCxHQUNBRSxFQUFBRixHQUNBRyxFQUFBSCxJQUdBQyxFQUFBLFNBQUFELEdBQ0EsSUFBQSxHQUFBSSxLQUFBVCxHQUFBLENBQ0EsR0FBQVUsR0FBQSxDQUNBVixHQUFBUyxHQUFBRSxNQUFBLFNBQUFDLEVBQUFDLEdBQ0EsTUFBQUQsS0FBQVAsR0FDQSxJQUFBSyxFQUNBZixFQUFBbUIsS0FBQVQsR0FFQUssS0FFQSxJQUVBLE1BS0FILEVBQUEsU0FBQUYsR0FDQSxJQUFBLEdBQUFVLEdBQUEsRUFBQSxFQUFBQSxFQUFBQSxJQUNBLE9BQUFmLEVBQUFDLEVBQUFjLElBQ0FmLEVBQUFDLEVBQUFjLEtBQUFmLEVBQUFFLEVBQUFhLElBQUFmLEVBQUFFLEVBQUFhLEtBQUFmLEVBQUFHLEVBQUFZLElBQ0FwQixFQUFBbUIsS0FBQVQsSUFNQUcsRUFBQSxTQUFBSCxHQUNBTCxFQUFBQyxFQUFBLElBQ0FELEVBQUFDLEVBQUEsS0FBQUQsRUFBQUUsRUFBQSxJQUFBRixFQUFBRSxFQUFBLEtBQUFGLEVBQUFHLEVBQUEsSUFDQVIsRUFBQW1CLEtBQUFULEdBR0FMLEVBQUFDLEVBQUEsSUFDQUQsRUFBQUMsRUFBQSxLQUFBRCxFQUFBRSxFQUFBLElBQUFGLEVBQUFFLEVBQUEsS0FBQUYsRUFBQUcsRUFBQSxJQUNBUixFQUFBbUIsS0FBQVQsR0FLQVYsR0FBQUYsR0FBQSxVQUFBLFNBQUF1QixHQUNBM0IsUUFBQUMsSUFBQTBCLEdBRUFuQixHQUNBLElBQUFRLEdBQUFSLEVBQUEsSUFBQSxFQUFBLElBQUEsR0FDQUcsR0FBQWlCLEtBQUFSLEtBQUFRLEtBQUFDLEtBQUFiLEVBQ0FSLEdBQUEsR0FDQU8sRUFBQUMsR0FFQVYsRUFBQW1CLE1BQUFULE1BQUFBLEVBQUFJLElBQUFRLEtBQUFSLElBQUFTLElBQUFELEtBQUFDLFVBSUE3QixRQUFBQyxJQUFBIiwiZmlsZSI6ImluZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIFdlYlNvY2tldFNlcnZlciA9IHJlcXVpcmUoJ3dzJykuU2VydmVyO1xudmFyIGh0dHAgPSByZXF1aXJlKCdodHRwJylcbnZhciBleHByZXNzID0gcmVxdWlyZSgnZXhwcmVzcycpO1xudmFyIHVybCA9IHJlcXVpcmUoJ3VybCcpO1xudmFyIHBvcnQgPSBwcm9jZXNzLmVudi5QT1JUIHx8IDUwMDA7XG5cbnZhciBhcHAgPSBleHByZXNzKCk7XG5hcHAudXNlKGV4cHJlc3Muc3RhdGljKF9fZGlybmFtZSArICcvcHVibGljJykpO1xuYXBwLmxpc3Rlbig4MCk7IC8vcG9ydCA4MCBuZWVkIHRvIHJ1biBhcyByb290XG5jb25zb2xlLmxvZyhcImFwcCBsaXN0ZW5pbmcgb24gJWQgXCIsIDgwKTtcblxudmFyIHNlcnZlciA9IGh0dHAuY3JlYXRlU2VydmVyKGFwcCk7XG5zZXJ2ZXIub24oJ3JlcXVlc3QnLCBhcHApO1xuc2VydmVyLmxpc3Rlbihwb3J0KTtcbmNvbnNvbGUubG9nKFwiaHR0cCBzZXJ2ZXIgbGlzdGVuaW5nIG9uICVkXCIsIHBvcnQpO1xuXG52YXIgd3NzID0gbmV3IFdlYlNvY2tldFNlcnZlcih7IHNlcnZlcjogc2VydmVyIH0pO1xud3NzLm9uKCdjb25uZWN0aW9uJywgZnVuY3Rpb24od3MpIHtcbiAgY29uc29sZS5pbmZvKFwid2Vic29ja2V0IGNvbm5lY3Rpb24gb3BlblwiKTtcblxuICB2YXIgbG9jYXRpb24gPSB1cmwucGFyc2Uod3MudXBncmFkZVJlcS51cmwsIHRydWUpO1xuICAvLyB5b3UgbWlnaHQgdXNlIGxvY2F0aW9uLnF1ZXJ5LmFjY2Vzc190b2tlbiB0byBhdXRoZW50aWNhdGUgb3Igc2hhcmUgc2Vzc2lvbnNcbiAgLy8gb3Igd3MudXBncmFkZVJlcS5oZWFkZXJzLmNvb2tpZSAoc2VlIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzE2Mzk1MjIwLzE1MTMxMilcblxuICB2YXIgdHVybiA9IDA7XG4gIHZhciBib2FyZFN0YXRlID0ge1xuICAgICdhJzogW251bGwsIG51bGwsIG51bGxdLFxuICAgICdiJzogW251bGwsIG51bGwsIG51bGxdLFxuICAgICdjJzogW251bGwsIG51bGwsIG51bGxdXG4gIH07XG4gIHZhciBjaGVja0Zvcldpbm5lciA9IGZ1bmN0aW9uKHRva2VuKSB7XG4gICAgY2hlY2tSb3dzKHRva2VuKTtcbiAgICBjaGVja0NvbHModG9rZW4pO1xuICAgIGNoZWNrRGlhZyh0b2tlbik7XG4gIH07XG5cbiAgdmFyIGNoZWNrUm93cyA9IGZ1bmN0aW9uKHRva2VuKSB7XG4gICAgZm9yICh2YXIgcm93IGluIGJvYXJkU3RhdGUpIHtcbiAgICAgIHZhciBjb3VudCA9IDA7XG4gICAgICBib2FyZFN0YXRlW3Jvd10uZXZlcnkoZnVuY3Rpb24odmFsdWUsIGluZGV4KSB7XG4gICAgICAgIGlmICh2YWx1ZSA9PT0gdG9rZW4pIHtcbiAgICAgICAgICBpZiAoY291bnQgPT09IDIpIHtcbiAgICAgICAgICAgIHdzLnNlbmQodG9rZW4pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb3VudCsrO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIGNoZWNrQ29scyA9IGZ1bmN0aW9uKHRva2VuKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCAzOyBpKyspIHtcbiAgICAgIGlmIChib2FyZFN0YXRlLmFbaV0gIT09IG51bGwpIHtcbiAgICAgICAgaWYgKGJvYXJkU3RhdGUuYVtpXSA9PT0gYm9hcmRTdGF0ZS5iW2ldICYmIGJvYXJkU3RhdGUuYltpXSA9PT0gYm9hcmRTdGF0ZS5jW2ldKSB7XG4gICAgICAgICAgd3Muc2VuZCh0b2tlbik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgdmFyIGNoZWNrRGlhZyA9IGZ1bmN0aW9uKHRva2VuKSB7XG4gICAgaWYgKGJvYXJkU3RhdGUuYVswXSkge1xuICAgICAgaWYgKGJvYXJkU3RhdGUuYVswXSA9PT0gYm9hcmRTdGF0ZS5iWzFdICYmIGJvYXJkU3RhdGUuYlsxXSA9PT0gYm9hcmRTdGF0ZS5jWzJdKSB7XG4gICAgICAgIHdzLnNlbmQodG9rZW4pO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoYm9hcmRTdGF0ZS5hWzJdKSB7XG4gICAgICBpZiAoYm9hcmRTdGF0ZS5hWzJdID09PSBib2FyZFN0YXRlLmJbMV0gJiYgYm9hcmRTdGF0ZS5iWzFdID09PSBib2FyZFN0YXRlLmNbMF0pIHtcbiAgICAgICAgd3Muc2VuZCh0b2tlbik7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIHdzLm9uKCdtZXNzYWdlJywgZnVuY3Rpb24obWVzc2FnZSkge1xuICAgIGNvbnNvbGUubG9nKG1lc3NhZ2UpO1xuXG4gICAgdHVybisrO1xuICAgIHZhciB0b2tlbiA9ICh0dXJuJTIgPT09IDEpID8gJ1gnOidPJztcbiAgICBib2FyZFN0YXRlW21vdmUucm93XVttb3ZlLmNvbF0gPSB0b2tlbjtcbiAgICBpZiAodHVybiA+PSA1KSB7XG4gICAgICBjaGVja0Zvcldpbm5lcih0b2tlbik7XG4gICAgfVxuICAgIHdzLnNlbmQoeyd0b2tlbic6IHRva2VuLCAncm93JzogbW92ZS5yb3csICdjb2wnOiBtb3ZlLmNvbH0pO1xuICB9KTtcbn0pO1xuXG5jb25zb2xlLmxvZyhcIndlYnNvY2tldCBzZXJ2ZXIgY3JlYXRlZFwiKTtcblxuXG4vLyB2YXIgc2VydmVyID0gcmVxdWlyZSgnaHR0cCcpLmNyZWF0ZVNlcnZlcigpO1xuLy8gdmFyIHVybCA9IHJlcXVpcmUoJ3VybCcpO1xuLy8gdmFyIFdlYlNvY2tldFNlcnZlciA9IHJlcXVpcmUoJ3dzJykuU2VydmVyO1xuLy8gdmFyIHdzcyA9IG5ldyBXZWJTb2NrZXRTZXJ2ZXIoeyBzZXJ2ZXI6IHNlcnZlciB9KTtcbi8vIHZhciBleHByZXNzID0gcmVxdWlyZSgnZXhwcmVzcycpO1xuLy8gdmFyIGFwcCA9IGV4cHJlc3MoKTtcbi8vIHZhciBwb3J0ID0gcHJvY2Vzcy5lbnYuUE9SVCB8fCA1MDAwO1xuXG4vLyBhcHAudXNlKGV4cHJlc3Muc3RhdGljKF9fZGlybmFtZSArICcvcHVibGljJykpO1xuXG4vLyBhcHAudXNlKGZ1bmN0aW9uIChyZXEsIHJlcykge1xuLy8gICByZXMuc2VuZCh7IG1zZzogXCJoZWxsb1wiIH0pO1xuLy8gfSk7XG5cbi8vIHdzcy5vbignY29ubmVjdGlvbicsIGZ1bmN0aW9uIGNvbm5lY3Rpb24od3MpIHtcbi8vICAgdmFyIGxvY2F0aW9uID0gdXJsLnBhcnNlKHdzLnVwZ3JhZGVSZXEudXJsLCB0cnVlKTtcbi8vICAgLy8geW91IG1pZ2h0IHVzZSBsb2NhdGlvbi5xdWVyeS5hY2Nlc3NfdG9rZW4gdG8gYXV0aGVudGljYXRlIG9yIHNoYXJlIHNlc3Npb25zXG4vLyAgIC8vIG9yIHdzLnVwZ3JhZGVSZXEuaGVhZGVycy5jb29raWUgKHNlZSBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xNjM5NTIyMC8xNTEzMTIpXG5cbi8vICAgdmFyIHR1cm4gPSAwO1xuLy8gICB2YXIgYm9hcmRTdGF0ZSA9IHtcbi8vICAgICAnYSc6IFtudWxsLCBudWxsLCBudWxsXSxcbi8vICAgICAnYic6IFtudWxsLCBudWxsLCBudWxsXSxcbi8vICAgICAnYyc6IFtudWxsLCBudWxsLCBudWxsXVxuLy8gICB9O1xuLy8gICB2YXIgY2hlY2tGb3JXaW5uZXIgPSBmdW5jdGlvbih0b2tlbikge1xuLy8gICAgIGNoZWNrUm93cyh0b2tlbik7XG4vLyAgICAgY2hlY2tDb2xzKHRva2VuKTtcbi8vICAgICBjaGVja0RpYWcodG9rZW4pO1xuLy8gICB9O1xuXG4vLyAgIHZhciBjaGVja1Jvd3MgPSBmdW5jdGlvbih0b2tlbikge1xuLy8gICAgIGZvciAodmFyIHJvdyBpbiBib2FyZFN0YXRlKSB7XG4vLyAgICAgICB2YXIgY291bnQgPSAwO1xuLy8gICAgICAgYm9hcmRTdGF0ZVtyb3ddLmV2ZXJ5KGZ1bmN0aW9uKHZhbHVlLCBpbmRleCkge1xuLy8gICAgICAgICBpZiAodmFsdWUgPT09IHRva2VuKSB7XG4vLyAgICAgICAgICAgaWYgKGNvdW50ID09PSAyKSB7XG4vLyAgICAgICAgICAgICB3cy5zZW5kKCd3aW5uZXInLCB0b2tlbik7XG4vLyAgICAgICAgICAgfSBlbHNlIHtcbi8vICAgICAgICAgICAgIGNvdW50Kys7XG4vLyAgICAgICAgICAgfVxuLy8gICAgICAgICAgIHJldHVybiB0cnVlO1xuLy8gICAgICAgICB9XG4vLyAgICAgICAgIHJldHVybiBmYWxzZTtcbi8vICAgICAgIH0pO1xuLy8gICAgIH1cbi8vICAgfTtcblxuLy8gICB2YXIgY2hlY2tDb2xzID0gZnVuY3Rpb24odG9rZW4pIHtcbi8vICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDM7IGkrKykge1xuLy8gICAgICAgaWYgKGJvYXJkU3RhdGUuYVtpXSAhPT0gbnVsbCkge1xuLy8gICAgICAgICBpZiAoYm9hcmRTdGF0ZS5hW2ldID09PSBib2FyZFN0YXRlLmJbaV0gJiYgYm9hcmRTdGF0ZS5iW2ldID09PSBib2FyZFN0YXRlLmNbaV0pIHtcbi8vICAgICAgICAgICB3cy5zZW5kKCd3aW5uZXInLCB0b2tlbik7XG4vLyAgICAgICAgIH1cbi8vICAgICAgIH1cbi8vICAgICB9XG4vLyAgIH07XG5cbi8vICAgdmFyIGNoZWNrRGlhZyA9IGZ1bmN0aW9uKHRva2VuKSB7XG4vLyAgICAgaWYgKGJvYXJkU3RhdGUuYVswXSkge1xuLy8gICAgICAgaWYgKGJvYXJkU3RhdGUuYVswXSA9PT0gYm9hcmRTdGF0ZS5iWzFdICYmIGJvYXJkU3RhdGUuYlsxXSA9PT0gYm9hcmRTdGF0ZS5jWzJdKSB7XG4vLyAgICAgICAgIHdzLnNlbmQoJ3dpbm5lcicsIHRva2VuKTtcbi8vICAgICAgIH1cbi8vICAgICB9XG4vLyAgICAgaWYgKGJvYXJkU3RhdGUuYVsyXSkge1xuLy8gICAgICAgaWYgKGJvYXJkU3RhdGUuYVsyXSA9PT0gYm9hcmRTdGF0ZS5iWzFdICYmIGJvYXJkU3RhdGUuYlsxXSA9PT0gYm9hcmRTdGF0ZS5jWzBdKSB7XG4vLyAgICAgICAgIHdzLnNlbmQoJ3dpbm5lcicsIHRva2VuKTtcbi8vICAgICAgIH1cbi8vICAgICB9XG4vLyAgIH07XG5cbi8vICAgd3Mub24oJ3R1cm5TdGFydCcsIGZ1bmN0aW9uKG1vdmUpIHtcbi8vICAgICB0dXJuKys7XG4vLyAgICAgdmFyIHRva2VuID0gKHR1cm4lMiA9PT0gMSkgPyAnWCc6J08nO1xuLy8gICAgIGJvYXJkU3RhdGVbbW92ZS5yb3ddW21vdmUuY29sXSA9IHRva2VuO1xuLy8gICAgIGlmICh0dXJuID49IDUpIHtcbi8vICAgICAgIGNoZWNrRm9yV2lubmVyKHRva2VuKTtcbi8vICAgICB9XG4vLyAgICAgd3Muc2VuZCgndHVybkZpbmlzaCcsIHsndG9rZW4nOiB0b2tlbiwgJ3Jvdyc6IG1vdmUucm93LCAnY29sJzogbW92ZS5jb2x9KTtcbi8vICAgfSk7XG5cbi8vIH0pO1xuXG4vLyBzZXJ2ZXIub24oJ3JlcXVlc3QnLCBhcHApO1xuLy8gc2VydmVyLmxpc3Rlbihwb3J0LCBmdW5jdGlvbiAoKSB7IGNvbnNvbGUubG9nKCdMaXN0ZW5pbmcgb24gJyArIHNlcnZlci5hZGRyZXNzKCkucG9ydCkgfSk7XG5cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==